import{L as n}from"./localeText-D5y6HiIJ.js";import{B as D,r as f,I as N,G as A,D as F,c as a,d as p,a as e,b as o,m as w,e as V,y as I,C as O,v as U,F as C,i as L,n as h,u as J,A as K,t as _,g as R,z as M,f as t,q as E,j as $,x as Y,_ as j,o as Z,w as P,S as T}from"./index-5h-0Ryy7.js";const Q={class:"p-3"},X={key:0},ee={for:"PayloadURL",class:"form-label fw-bold text-muted"},se=["disabled"],te={for:"ContentType",class:"form-label fw-bold text-muted"},le=["disabled"],oe={class:"form-label fw-bold text-muted"},ne={class:"form-check form-switch mb-2"},ae=["disabled"],ie={class:"form-check-label",for:"VerifySSL"},de={key:0,class:"alert-danger alert rounded-3"},ue={class:"form-label fw-bold text-muted"},re={class:"card rounded-3"},ce={class:"card-body d-flex gap-2 flex-column"},be={class:"d-flex gap-2"},ve={class:"flex-grow-1"},me=["disabled","onUpdate:modelValue"],fe={class:"flex-grow-1"},pe=["disabled","onUpdate:modelValue"],ke=["onClick"],ye={class:"form-label fw-bold text-muted"},_e={class:"form-check form-check-inline"},he=["disabled","id","value"],xe=["for"],ge={class:"form-label fw-bold text-muted"},Se={class:"form-check form-switch mb-2"},we=["disabled"],$e={class:"form-check-label",for:"IsActive"},He={key:0,class:"alert alert-danger rounded-3"},We={class:"d-flex gap-2"},Ce={class:"d-flex align-items-center"},Le={class:"mb-0"},B=D({__name:"addWebHook",props:["webHook"],emits:["refresh","delete"],async setup(d,{emit:m}){let y,r;const s=f({ContentType:String,Headers:Object,IsActive:Boolean,Notes:String,PayloadURL:String,SubscribedActions:Array,VerifySSL:Boolean,WebHookID:String}),u=d;u.webHook?s.value={...u.webHook}:([y,r]=N(()=>R("/api/webHooks/createWebHook",{},g=>{s.value=g.data})),await y,r());const k=f({peer_created:A("Peer Created"),peer_deleted:A("Peer Deleted"),peer_updated:A("Peer Updated")}),x=m,i=F(),c=f(!1),S=f(""),v=f(!1),G=async g=>{g&&g.preventDefault(),v.value=!0,await M("/api/webHooks/updateWebHook",s.value,l=>{l.status?(x("refresh"),i.newMessage("Server","Webhook saved","success")):(c.value=!0,S.value=l.message,i.newMessage("Server","Webhook failed to save","danger")),v.value=!1})},z=async()=>{v.value=!0,await M("/api/webHooks/deleteWebHook",s.value,g=>{g.status?(x("delete"),i.newMessage("Server","Webhook deleted","success")):(c.value=!0,S.value=g.message,i.newMessage("Server","Webhook failed to delete","danger")),v.value=!1})};return(g,l)=>(t(),a("div",Q,[d.webHook?p("",!0):(t(),a("div",X,[e("h6",null,[o(n,{t:"Add Webhook"})]),e("p",null,[o(n,{t:"WGDashboard will sent a POST Request to the URL below with details of any subscribed events."})])])),e("form",{onSubmit:l[7]||(l[7]=b=>G(b)),class:"d-flex flex-column gap-2"},[e("div",null,[e("label",ee,[e("small",null,[o(n,{t:"Payload URL"}),l[8]||(l[8]=V("* "))])]),w(e("input",{required:"",disabled:v.value,id:"PayloadURL","onUpdate:modelValue":l[0]||(l[0]=b=>s.value.PayloadURL=b),class:"form-control rounded-3",type:"url"},null,8,se),[[I,s.value.PayloadURL]])]),e("div",null,[e("label",te,[e("small",null,[o(n,{t:"Content Type"}),l[9]||(l[9]=V("* "))])]),w(e("select",{disabled:v.value,id:"ContentType","onUpdate:modelValue":l[1]||(l[1]=b=>s.value.ContentType=b),class:"form-select rounded-3",required:""},l[10]||(l[10]=[e("option",{value:"application/json"}," application/json ",-1),e("option",{value:"application/x-www-form-urlencoded"}," application/x-www-form-urlencoded ",-1)]),8,le),[[O,s.value.ContentType]])]),e("div",null,[e("label",oe,[e("small",null,[o(n,{t:"Verify SSL"})])]),e("div",null,[e("div",ne,[w(e("input",{disabled:v.value,"onUpdate:modelValue":l[2]||(l[2]=b=>s.value.VerifySSL=b),class:"form-check-input",type:"checkbox",role:"switch",id:"VerifySSL"},null,8,ae),[[U,s.value.VerifySSL]]),e("label",ie,[o(n,{t:s.value.VerifySSL?"Enabled":"Disabled"},null,8,["t"])])]),s.value.VerifySSL?p("",!0):(t(),a("div",de,[l[11]||(l[11]=e("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),o(n,{t:"We highly suggest to enable SSL verification"})]))])]),e("div",null,[e("label",ue,[e("small",null,[o(n,{t:"Custom Headers"})])]),e("div",re,[e("div",ce,[(t(!0),a(C,null,L(s.value.Headers,(b,H)=>(t(),a("div",be,[e("div",ve,[w(e("input",{class:"form-control rounded-3 form-control-sm",disabled:v.value,"onUpdate:modelValue":W=>b.key=W,placeholder:"Key"},null,8,me),[[I,b.key]])]),e("div",fe,[w(e("input",{class:"form-control rounded-3 form-control-sm",disabled:v.value,"onUpdate:modelValue":W=>b.value=W,placeholder:"Value"},null,8,pe),[[I,b.value]])]),e("button",{class:h([{disabled:v.value},"btn btn-sm bg-danger-subtle text-danger-emphasis border-danger-subtle rounded-3"]),type:"button",onClick:W=>delete s.value.Headers[H]},l[12]||(l[12]=[e("i",{class:"bi bi-trash-fill"},null,-1)]),10,ke)]))),256)),e("button",{type:"button",class:h([{disabled:v.value},"btn btn-sm bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-3"]),onClick:l[3]||(l[3]=b=>s.value.Headers[J(K)().toString()]={key:"",value:""})},[l[13]||(l[13]=e("i",{class:"bi bi-plus-lg me-2"},null,-1)),o(n,{t:"Header"})],2)])])]),l[15]||(l[15]=e("hr",null,null,-1)),e("div",null,[e("label",ye,[e("small",null,[o(n,{t:"Subscribed Actions"})])]),e("div",null,[(t(!0),a(C,null,L(k.value,(b,H)=>(t(),a("div",_e,[w(e("input",{class:"form-check-input",disabled:s.value.SubscribedActions.length===1&&s.value.SubscribedActions.includes(H)||v.value,type:"checkbox",id:H,value:H,"onUpdate:modelValue":l[4]||(l[4]=W=>s.value.SubscribedActions=W)},null,8,he),[[U,s.value.SubscribedActions]]),e("label",{class:"form-check-label",for:H},_(b),9,xe)]))),256))])]),l[16]||(l[16]=e("hr",null,null,-1)),e("div",null,[e("label",ge,[e("small",null,[o(n,{t:"Enable Webhook"})])]),e("div",null,[e("div",Se,[w(e("input",{disabled:v.value,"onUpdate:modelValue":l[5]||(l[5]=b=>s.value.IsActive=b),class:"form-check-input",type:"checkbox",role:"switch",id:"IsActive"},null,8,we),[[U,s.value.IsActive]]),e("label",$e,[o(n,{t:s.value.IsActive?"Yes":"No"},null,8,["t"])])])])]),c.value?(t(),a("div",He,_(S.value),1)):p("",!0),e("div",We,[e("button",{type:"submit",class:h([{disabled:v.value},"ms-auto btn bg-success-subtle text-success-emphasis border-success-subtle rounded-3"])},[o(n,{t:"Save"})],2)]),d.webHook?(t(),a(C,{key:1},[l[14]||(l[14]=e("hr",null,null,-1)),e("div",Ce,[e("h6",Le,[o(n,{t:"Danger Zone"})]),e("button",{onClick:l[6]||(l[6]=b=>z()),type:"button",class:h([{disabled:v.value},"btn bg-danger-subtle text-danger-emphasis border-danger-subtle rounded-3 ms-auto"])},[o(n,{t:"Delete"})],2)])],64)):p("",!0)],32)]))}}),De={class:"d-flex flex-column gap-3"},Ve={class:"text-muted"},Ae={key:0},Ie={key:1},Ue={key:2},Pe={class:"d-flex gap-4 align-items-center"},Re={class:"text-muted"},Me={key:0},Te={key:1},Be={class:"text-muted"},Ne={class:"table-responsive"},Ee={class:"table"},je={scope:"col"},qe={scope:"col"},Ge={scope:"col"},ze={style:{"white-space":"nowrap"}},Fe={key:0},Oe={key:1},Je={key:2},Ke={style:{"white-space":"nowrap","overflow-x":"scroll"}},Ye={class:"bg-body-tertiary p-3 rounded-3"},Ze={class:"mb-0"},q=D({__name:"webHookSession",props:["session"],setup(d){const m=d,y=E(()=>JSON.stringify(m.session.Data,null,4));return(r,s)=>(t(),a("div",De,[e("div",null,[e("small",Ve,[o(n,{t:"Status"})]),e("h3",{class:h({"text-success":d.session.Status===0,"text-danger":d.session.Status===1})},[d.session.Status===0?(t(),a("span",Ae,[s[0]||(s[0]=e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)),o(n,{t:"Success"})])):d.session.Status===1?(t(),a("span",Ie,[s[1]||(s[1]=e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)),o(n,{t:"Failed"})])):d.session.Status===-1?(t(),a("span",Ue,[s[2]||(s[2]=e("i",{class:"spinner-border me-2"},null,-1)),o(n,{t:"Requesting..."})])):p("",!0)],2),e("div",Pe,[e("div",null,[e("small",Re,[o(n,{t:"Started At"})]),e("h6",null,_(d.session.StartDate),1)]),d.session.EndDate?(t(),a("div",Me,s[3]||(s[3]=[e("i",{class:"bi bi-arrow-right"},null,-1)]))):p("",!0),d.session.EndDate?(t(),a("div",Te,[e("small",Be,[o(n,{t:"Ended At"})]),e("h6",null,_(d.session.EndDate),1)])):p("",!0)])]),e("div",null,[e("h6",null,[o(n,{t:"Logs"})]),e("div",Ne,[e("table",Ee,[e("thead",null,[e("tr",null,[e("th",je,[o(n,{t:"Datetime"})]),e("th",qe,[o(n,{t:"Status"})]),e("th",Ge,[o(n,{t:"Message"})])])]),e("tbody",null,[(t(!0),a(C,null,L([...d.session.Logs.Logs].reverse(),u=>(t(),a("tr",null,[e("td",ze,_(u.LogTime),1),e("td",{style:{"white-space":"nowrap"},class:h({"text-success":u.Status===0,"text-danger":u.Status===1})},[u.Status===0?(t(),a("span",Fe,s[4]||(s[4]=[e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)]))):u.Status===1?(t(),a("span",Oe,s[5]||(s[5]=[e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)]))):u.Status===-1?(t(),a("span",Je,s[6]||(s[6]=[e("i",{class:"bi bi-circle me-2"},null,-1)]))):p("",!0)],2),e("td",Ke,_(u.Message),1)]))),256))])])])]),e("div",null,[e("h6",null,[o(n,{t:"Data"})]),e("div",Ye,[e("pre",Ze,[e("code",null,_(y.value),1)])])])]))}}),Qe={class:"card"},Xe={class:"card-body"},es={key:0},ss={key:1},ts={key:2},ls=D({__name:"previousWebHookSession",props:["session"],setup(d){const m=f(!0);return(y,r)=>(t(),a("div",Qe,[e("div",Xe,[e("p",{class:"d-flex mb-0",role:"button",onClick:r[0]||(r[0]=s=>m.value=!m.value)},[e("span",{class:h({"text-success":d.session.Status===0,"text-danger":d.session.Status===1})},[d.session.Status===0?(t(),a("span",es,r[1]||(r[1]=[e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)]))):d.session.Status===1?(t(),a("span",ss,r[2]||(r[2]=[e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)]))):d.session.Status===-1?(t(),a("span",ts,r[3]||(r[3]=[e("i",{class:"spinner-border spinner-border-sm me-2"},null,-1)]))):p("",!0)],2),V(" "+_(d.session.StartDate)+" ",1),r[4]||(r[4]=e("i",{class:"bi bi-chevron-right ms-auto"},null,-1))]),m.value?p("",!0):(t(),$(q,{key:0,session:d.session,class:"mt-2"},null,8,["session"]))])]))}}),os={key:0},ns={class:"p-3"},as={class:"mb-3"},is={key:0,class:"border-top p-3"},ds={class:"d-flex flex-column gap-2"},us={key:1,class:"p-3"},rs=D({__name:"webHookSessions",props:["webHook"],async setup(d){let m,y;const r=d,s=f([]),u=f(void 0),k=async()=>{await R("/api/webHooks/getWebHookSessions",{WebHookID:r.webHook.WebHookID},i=>{s.value=i.data})};[m,y]=N(()=>k()),await m,y();const x=E(()=>{if(s.value)return s.value[0]});return u.value=setInterval(()=>{k()},5e3),Y(()=>{clearInterval(u.value)}),(i,c)=>x.value?(t(),a("div",os,[e("div",ns,[e("h6",as,[o(n,{t:"Latest Session"})]),(t(),$(q,{session:x.value,key:x.value.WebHookID},null,8,["session"]))]),s.value.length>1?(t(),a("div",is,[e("h6",null,[o(n,{t:"Previous Sessions"})]),e("div",ds,[(t(!0),a(C,null,L(s.value.slice(1),S=>(t(),$(ls,{session:S,key:S.WebHookSessionID},null,8,["session"]))),128))])])):p("",!0)])):(t(),a("div",us,c[0]||(c[0]=[e("div",{class:"bg-body-tertiary p-3 w-100 d-flex rounded-3"},[e("h6",{class:"mb-0 m-auto"},"No Sessions")],-1)])))}}),cs=j(rs,[["__scopeId","data-v-7b6e949e"]]),bs={class:"text-body w-100 h-100 pb-2 position-relative"},vs={class:"w-100 h-100 card rounded-3"},ms={class:"border-bottom z-0"},fs={class:"d-flex text-body align-items-center sticky-top p-3 bg-body-tertiary rounded-top-3",style:{"border-top-right-radius":"0 !important"}},ps={class:"my-2"},ks={key:0,class:"row h-100 g-0"},ys={class:"col-sm-4 border-end d-flex flex-column clientListContainer"},_s={class:"d-flex flex-column overflow-y-scroll",style:{flex:"1 0 0"}},hs={class:"list-group d-flex flex-column d-flex h-100"},xs=["onClick"],gs={class:"mb-0 fw-bold text-body url"},Ss={class:"url mb-0"},ws={key:1,class:"flex-grow-1 d-flex text-muted"},$s={key:0,class:"col-sm-8 clientViewerContainer d-flex flex-column"},Hs={class:"overflow-scroll",style:{flex:"1 0 0"}},Ws={class:"navbar navbar-expand-lg bg-body-tertiary sticky-top"},Cs={class:"container-fluid"},Ls={class:"navbar-nav gap-2"},Ds={class:"nav-item"},Vs={class:"nav-item"},As={class:"p-3"},Is=D({__name:"dashboardWebHooks",setup(d){const m=f([]),y=f(!1);Z(async()=>{await r(),y.value=!0});const r=async()=>{await R("/api/webHooks/getWebHooks",{},x=>{m.value=x.data})},s=f(!1),u=f(void 0),k=f("edit");return(x,i)=>(t(),a("div",bs,[e("div",vs,[e("div",ms,[e("div",fs,[e("h6",ps,[i[7]||(i[7]=e("i",{class:"bi bi-plug-fill me-2"},null,-1)),o(n,{t:"Webhooks"})]),s.value?(t(),a("button",{key:1,class:"btn btn-sm bg-secondary-subtle text-secondary-emphasis border-1 border-secondary-subtle rounded-3 shadow-sm ms-auto",onClick:i[1]||(i[1]=c=>s.value=!1)},[i[9]||(i[9]=e("i",{class:"bi bi-chevron-left me-2"},null,-1)),o(n,{t:"Back"})])):(t(),a("button",{key:0,class:"btn btn-sm bg-primary-subtle text-primary-emphasis border-1 border-primary-subtle rounded-3 shadow-sm ms-auto",onClick:i[0]||(i[0]=c=>{s.value=!0,u.value=void 0})},[i[8]||(i[8]=e("i",{class:"bi bi-plus-circle-fill me-2"},null,-1)),o(n,{t:"Webhook"})]))])]),s.value?(t(),$(T,{key:1},{default:P(()=>[o(B,{onRefresh:i[6]||(i[6]=c=>{u.value=void 0,s.value=!1,r()})})]),_:1})):(t(),a("div",ks,[e("div",ys,[e("div",_s,[e("div",hs,[m.value.length>0?(t(!0),a(C,{key:0},L(m.value,c=>(t(),a("a",{role:"button",onClick:S=>u.value=c,class:h([{active:u.value?.WebHookID===c.WebHookID},"list-group-item list-group-item-action"]),"aria-current":"true"},[e("p",gs,_(c.PayloadURL),1),e("p",Ss,[o(n,{t:"Subscribed Actions"}),V(": "+_(c.SubscribedActions.join(", ")),1)])],10,xs))),256)):(t(),a("div",ws,[o(n,{t:"No Webhooks",class:"m-auto"})]))])])]),u.value?(t(),a("div",$s,[e("div",Hs,[e("nav",Ws,[e("div",Cs,[e("div",null,[e("ul",Ls,[e("li",Ds,[e("a",{onClick:i[2]||(i[2]=c=>k.value="edit"),class:h([{active:k.value==="edit"},"nav-link rounded-3"]),role:"button"},[o(n,{t:"Edit"})],2)]),e("li",Vs,[e("a",{class:h([{active:k.value==="sessions"},"nav-link rounded-3"]),onClick:i[3]||(i[3]=c=>k.value="sessions"),role:"button"},[o(n,{t:"Sessions"})],2)])])])])]),k.value==="edit"?(t(),$(B,{key:u.value,onDelete:i[4]||(i[4]=c=>{r(),u.value=void 0}),webHook:u.value,onRefresh:i[5]||(i[5]=c=>r())},null,8,["webHook"])):k.value==="sessions"?(t(),$(T,{key:1},{fallback:P(()=>[e("div",As,[o(n,{t:"Loading..."})])]),default:P(()=>[(t(),$(cs,{key:u.value,webHook:u.value},null,8,["webHook"]))]),_:1})):p("",!0)])])):p("",!0)]))])]))}}),Rs=j(Is,[["__scopeId","data-v-e0f0e683"]]);export{Rs as default};
